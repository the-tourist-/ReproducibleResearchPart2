source('~/GitHub/ReproducibleResearchPart2/LoadAndPrepareData.R')
View(stormData)
str(stormData)
require(plyr)
ddply(stormData, .(EVTYPE), summarise, meanFatalities=mean(FATALITITIES), sumFatalities=sum(FATALITIES))
ddply(stormData, .(EVTYPE), summarise, meanFatalities=mean(FATALITIES), sumFatalities=sum(FATALITIES))
ddply(stormData, .(toupper(EVTYPE)), summarise, meanFatalities=mean(FATALITIES), sumFatalities=sum(FATALITIES))
ddply(stormData, .(toupper(gsub("\\b([a-z])([a-z]+)", "\\U\\1\\L\\2" ,EVTYPES, perl=TRUE))), summarise, meanFatalities=mean(FATALITIES), sumFatalities=sum(FATALITIES))
damageByEvenType <- ddply(stormData, .(eventType=toupper(gsub("\\b([a-z])([a-z]+)", "\\U\\1\\L\\2" ,EVTYPE, perl=TRUE))), summarise, meanFatalities=mean(FATALITIES), sumFatalities=sum(FATALITIES), meanInjuries=mean(INJURIES), sumInjuries=sum(INJURIES), meanPropertyDamage=mean(PROPDMG), sumPropertyDamage=sum(PROPDMG), meanPropertyDamageExp=mean(PROPDMGEXP), sumPropertyDamageExp=sum(PROPDMGEXP), meanCropDamage=mean(CROPDMG), sumCropDamage=sum(CROPDMG), meanCropDamageExp=mean(CROPDMGEXP), sumCropDamageExp=sum(CROPDMGEXP))
damageByEvenType <- ddply(stormData, .(eventType=toupper(gsub("\\b([a-z])([a-z]+)", "\\U\\1\\L\\2" ,EVTYPE, perl=TRUE))), summarise, meanFatalities=mean(FATALITIES), sumFatalities=sum(FATALITIES), meanInjuries=mean(INJURIES), sumInjuries=sum(INJURIES), meanPropertyDamage=mean(PROPDMG), sumPropertyDamage=sum(PROPDMG), meanCropDamage=mean(CROPDMG), sumCropDamage=sum(CROPDMG))
rm(damageByEventType)
rm(damageByEvenType)
damageByEventType <- ddply(stormData, .(eventType=toupper(gsub("\\b([a-z])([a-z]+)", "\\U\\1\\L\\2" ,EVTYPE, perl=TRUE))), summarise, meanFatalities=mean(FATALITIES), sumFatalities=sum(FATALITIES), meanInjuries=mean(INJURIES), sumInjuries=sum(INJURIES), meanPropertyDamage=mean(PROPDMG), sumPropertyDamage=sum(PROPDMG), meanCropDamage=mean(CROPDMG), sumCropDamage=sum(CROPDMG))
header(damageByEventType[order(damageByEventType$sumInjuries+damageByEventType$sumFatalities),])
head(damageByEventType[order(damageByEventType$sumInjuries+damageByEventType$sumFatalities),])
head(damageByEventType[order(-damageByEventType$sumInjuries-damageByEventType$sumFatalities),])
head(damageByEventType[order(-damageByEventType$meanInjuries-damageByEventType$meanFatalities),])
damageByEventType <- ddply(stormData, .(eventType=toupper(gsub("\\b([a-z])([a-z]+)", "\\U\\1\\L\\2" ,EVTYPE, perl=TRUE))), summarise, meanFatalities=mean(FATALITIES)*count(EVTYPE), sumFatalities=sum(FATALITIES), meanInjuries=mean(INJURIES)*count(EVTYPE), sumInjuries=sum(INJURIES), meanPropertyDamage=mean(PROPDMG)*count(EVTYPE), sumPropertyDamage=sum(PROPDMG), meanCropDamage=mean(CROPDMG)*count(EVTYPE), sumCropDamage=sum(CROPDMG))
damageByEventType <- ddply(stormData, .(eventType=toupper(gsub("\\b([a-z])([a-z]+)", "\\U\\1\\L\\2" ,EVTYPE, perl=TRUE))), summarise, meanFatalities=mean(FATALITIES)*sum(1), sumFatalities=sum(FATALITIES), meanInjuries=mean(INJURIES)*sum(1), sumInjuries=sum(INJURIES), meanPropertyDamage=mean(PROPDMG)*count(EVTYPE), sumPropertyDamage=sum(PROPDMG), meanCropDamage=mean(CROPDMG)*count(EVTYPE), sumCropDamage=sum(CROPDMG))
damageByEventType <- ddply(stormData, .(eventType=toupper(gsub("\\b([a-z])([a-z]+)", "\\U\\1\\L\\2" ,EVTYPE, perl=TRUE))), summarise, meanFatalities=mean(FATALITIES)*sum(1), sumFatalities=sum(FATALITIES), meanInjuries=mean(INJURIES)*sum(1), sumInjuries=sum(INJURIES), meanPropertyDamage=mean(PROPDMG)*sum(1), sumPropertyDamage=sum(PROPDMG), meanCropDamage=mean(CROPDMG)*sum(1), sumCropDamage=sum(CROPDMG))
head(damageByEventType[order(-damageByEventType$meanInjuries-damageByEventType$meanFatalities),])
damageByEventType <- ddply(stormData, .(eventType=toupper(gsub("\\b([a-z])([a-z]+)", "\\U\\1\\L\\2" ,EVTYPE, perl=TRUE))), summarise, meanFatalities=mean(FATALITIES)*count(), sumFatalities=sum(FATALITIES), meanInjuries=mean(INJURIES)*count(), sumInjuries=sum(INJURIES), meanPropertyDamage=mean(PROPDMG)*sum(1), sumPropertyDamage=sum(PROPDMG), meanCropDamage=mean(CROPDMG)*sum(1), sumCropDamage=sum(CROPDMG))
damageByEventType <- ddply(stormData, .(eventType=toupper(gsub("\\b([a-z])([a-z]+)", "\\U\\1\\L\\2" ,EVTYPE, perl=TRUE))), summarise, meanFatalities=mean(FATALITIES)*count(stormData), sumFatalities=sum(FATALITIES), meanInjuries=mean(INJURIES)*count(stormData), sumInjuries=sum(INJURIES), meanPropertyDamage=mean(PROPDMG)*sum(1), sumPropertyDamage=sum(PROPDMG), meanCropDamage=mean(CROPDMG)*sum(1), sumCropDamage=sum(CROPDMG))
head(damageByEventType[order(-damageByEventType$meanInjuries-damageByEventType$meanFatalities),])
head(damageByEventType[order(-damageByEventType$sumPropertyDamage-damageByEventType$meanCropDamage),])
with(stormData, plot(sumPropertyDamage+sumCropDamage, sumFatalities+sumInjuries)
)
with(stormData, plot(stormData$sumPropertyDamage+sumCropDamage, sumFatalities+sumInjuries)
)
plot(stormData$sumPropertyDamage+stormData$sumCropDamage, stormData$sumFatalities+stormData$sumInjuries)
sum(is.na(stormData$PropertyDamage))
sum(is.na(stormData$propertyDamage))
sum(is.na(stormData$sumPropertyDamage))
with(damageByEventType, plot(sumPropertyDamage+sumCropDamage, sumFatalities+sumInjuries))
with(damageByEventType, plot(log(1+sumPropertyDamage+sumCropDamage), log(1+sumFatalities+sumInjuries))
)
head(damageByEventType[order(-damageByEventType$sumPropertyDamage-damageByEventType$meanCropDamage),])
source('~/GitHub/ReproducibleResearchPart2/LoadAndPrepareData.R')
